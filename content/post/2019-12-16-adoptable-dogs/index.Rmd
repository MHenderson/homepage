---
title: "(WIP) Tidy Tuesday: Adoptable Dogs"
description: "tt_load(2019, week = 51)"
author: Matthew Henderson
date: '2019-12-16'
slug: adoptable-dogs
categories:
  - posts
tags:
  - tidy-tuesday
editor_options: 
  chunk_output_type: console
draft: TRUE
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
        echo = TRUE,
     message = FALSE,
     warning = FALSE,
     comment = "#>",
    collapse = TRUE,
   fig.width = 8,
  fig.height = 8
)

ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())
```

```{r tuesdata, cache=TRUE}
library(tidytuesdayR)

tuesdata <- tt_load(2019, week = 51)
```

```{r names}
library(tidyverse)

tuesdata$dog_descriptions %>%
  mutate(
    name = tolower(name)
  ) %>% 
  group_by(name) %>%
  count() %>%
  arrange(desc(n)) %>%
  head(50) %>%
  ggplot(aes(reorder(name, n), n)) +
    geom_text(aes(label = name)) +
    coord_flip() +
    labs(
      x = "",
      y = ""
    ) +
    ylim(50, 300) +
    theme(
      axis.text.y = element_blank(),
      panel.grid.major.y = element_blank()
    )
```

```{r net_exports_std}
library(statebins)
library(viridis)

tuesdata$dog_moves %>%
  replace_na(list(exported = 0, imported = 0)) %>%
  ggplot(aes(state = location, fill = (exported - imported)/total)) +
    geom_statebins() +
    scale_fill_viridis(
     option = "magma", direction = -1
    ) +
    theme_statebins() +
    coord_equal()
```
